<div id="dashboard-container">
  <div id="tickets">
    <div class="container">
      <div class="row">
        <div class="col-8">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <h1>{{ group?.name }}</h1>
              </li>
              <li class="breadcrumb-item">
                <h1>{{ topic?.name }}</h1>
              </li>
            </ol>
          </nav>
        </div>
        <div class="col-4">
          <button
            type="button"
            class="btn btn-outline-primary"
            routerLink="../.."
            id="back"
          >
            Back
          </button>
        </div>
      </div>
      <div class="row">
        <hr />
        <div class="col">
          <h1>Tickets</h1>
          <button
            type="button"
            class="btn btn-outline-primary"
            routerLink="/dashboard/tickets/create"
          >
            Create new Ticket
          </button>
        </div>
      </div>
      <div class="row">
        <div
          class="col-3 d-flex align-items-stretch"
          *ngFor="let ticket of tickets"
        >
          <div class="card-group">
            <div
              class="card"
              (click)="navigateTicket(ticket)"
              [ngClass]="{
                'border-primary': ticket.status === 'OP',
                'border-warning': ticket.status === 'PE',
                'border-success': ticket.status === 'RE',
                'border-danger': ticket.status === 'EX'
              }"
            >
              <div class="card-header">
                <h3 class="card-title float-start">
                  {{ ticket.title }}
                </h3>
                <div class="icon-group float-end">
                  <div class="status d-inline m-1 fs-5">
                    <span
                      *ngIf="ticket.status === 'OP'"
                      [matTooltip]="
                        ticket.status === 'OP'
                          ? 'OPEN -' + ticket.last_updated_by.username
                          : ''
                      "
                      class="text-primary"
                      ><i class="fas fa-circle"></i
                    ></span>
                    <span
                      *ngIf="ticket.status === 'PE'"
                      [matTooltip]="
                        ticket.status === 'PE'
                          ? 'IN PENDING -' + ticket.last_updated_by.username
                          : ''
                      "
                      class="text-warning"
                      ><i class="fas fa-circle"></i
                    ></span>
                    <span
                      *ngIf="ticket.status === 'RE'"
                      [matTooltip]="
                        ticket.status === 'RE'
                          ? 'RESOLVED -' + ticket.last_updated_by.username
                          : ''
                      "
                      class="text-success"
                      ><i class="fas fa-circle"></i
                    ></span>
                    <span
                      *ngIf="ticket.status === 'EX'"
                      [matTooltip]="
                        ticket.status === 'EX'
                          ? 'EXPIRED -' + ticket.last_updated_by.username
                          : ''
                      "
                      class="text-danger"
                      ><i class="fas fa-circle"></i
                    ></span>
                  </div>
                  <div class="creation d-inline m-1 fs-5">
                    <span
                      [matTooltip]="
                        'Creation date: ' +
                        (ticket.created_at ? ticket.created_at : '')
                      "
                      class="text-secondary"
                      ><i class="fas fa-calendar"></i
                    ></span>
                  </div>
                  <div class="expiration d-inline m-1 fs-5">
                    <span
                      [matTooltip]="'Expiration date: ' + ticket.expiration.toLocaleString()"
                      class="text-secondary"
                      ><i class="fas fa-calendar-times"></i
                    ></span>
                  </div>
                </div>
              </div>
              <div class="card-body">
                Content:
                <p class="card-text text-truncate">{{ ticket.content }}</p>
              </div>
              <div class="card-footer">
                <small class="text-muted">
                  Creator: {{ ticket.creator.username }}</small
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
